<% content_for :head do %>
  <meta name="turbolinks-cache-control" content="no-cache">
<% end %>

<div class="row">
   <div class="col-auto">
     <div class="card" data-controller="dashboard">
      <div class="card-header">
        <%= t('controller.org_units') %>
      </div>
      <div class="card-body">
        <nav class="d-sm-block pl-0 py-3 sidebar" id="org_unit_tree" data-target="dashboard.tree">
          <%= arranged_tree_as_list(@org_units, sort_by: [:position],
                                                open_id: params[:clicked]) do |org_unit| %>
            <%= link_to " #{org_unit.name}", "#",
                  remote: true,
                  data: {
                    reflex: "click->DashboardReflex#cardboard",
                    reflex_root: "#tasksCardboard",
                    org_unit_id: org_unit.id
                  },
                  id: dom_id(org_unit),
                  class: ("org_unit" +
                          if org_unit.id == params[:clicked].to_i
                            " jstree-clicked"
                           end.to_s)
            %>
          <% end %>
        </nav>
      </div>
    </div>
  </div>
  <div id="dashboard-content" class="col">
    <%= render 'tasks/cards', columns: @columns, tasks_per_column: @tasks_per_column %>
  </div>
</div>

